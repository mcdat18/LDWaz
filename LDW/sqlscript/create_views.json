{
	"name": "create_views",
	"properties": {
		"folder": {
			"name": "Views_OPENROWSET"
		},
		"content": {
			"query": "-- 1. SELECT *, HEADER_ROW = TRUE\n\nCREATE VIEW lnd.vwSalesOrders\nAS\nSELECT *,\nCAST(fct.filepath(1) AS DATE) AS FilePathDate\nFROM \nOPENROWSET \n(\n    BULK 'sourcedatapartitionsalesorder/OrderDatePartition=*/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    HEADER_ROW = TRUE,\n    FIELDTERMINATOR ='|'\n) AS fct;\nGO\n\nCREATE VIEW lnd.vwSalesOrdersLines\nAS\nSELECT *,\nCAST(fct.filepath(1) AS DATE) AS FilePathDate\nFROM \nOPENROWSET \n(\n    BULK 'sourcedatapartitionsalesorderline/OrderDate=*/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    HEADER_ROW = TRUE,\n    FIELDTERMINATOR ='|'\n) AS fct;\nGO\n\nCREATE VIEW lnd.vwCustomers\nAS\nSELECT * FROM \nOPENROWSET \n(\n    BULK 'Sales_Customers/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    HEADER_ROW = TRUE,\n    FIELDTERMINATOR ='|'\n) AS fct;\nGO\n\n-- 2. SELECT specific columns\n\nCREATE VIEW lnd.vwCities\nAS\nSELECT CityID,\n        CityName,\n        StateProvinceID,\n        LatestRecordedPopulation\nFROM \nOPENROWSET \n(\n    BULK 'Application_Cities/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    HEADER_ROW = TRUE,\n    FIELDTERMINATOR ='|'\n) AS fct;\nGO\n\n-- SELECT * and WITH to Define Columns type\n\nCREATE VIEW lnd.vwStateProvinces\nAS\nSELECT * FROM \nOPENROWSET \n(\n    BULK 'Application_StateProvinces/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    HEADER_ROW = TRUE,\n    FIELDTERMINATOR ='|'\n)\nWITH\n(\n    StateProvinceID TINYINT,\n    StateProvinceCode CHAR(2),\n    StateProvinceName VARCHAR(30),\n    CountryID TINYINT,\n    SalesTerritory VARCHAR(14),\n    LatestRecordedPopulation INT\n) AS fct;\nGO\n\nCREATE VIEW lnd.vwCountries\nAS\nSELECT * FROM \nOPENROWSET \n(\n    BULK 'Application_Countries/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    FIRSTROW = 2,\n    FIELDTERMINATOR ='|'\n)\nWITH\n(\n    CountryID TINYINT 1,\n    Country VARCHAR(50) 2,\n    IsoCode3 CHAR(3) 4,\n    CountryType VARCHAR(50) 6,\n    LatestRecordedPopulation INT 7,\n    Continent VARCHAR(50) 8,\n    Region VARCHAR(50) 9,\n    Subregion VARCHAR(50) 10\n) AS fct;\nGO\n\n-- The remainder of the Views created will use the HEADER_ROW = TRUE syntax with SELECT * for code brevity\n\nCREATE VIEW lnd.vwBuyingGroups\nAS\nSELECT * FROM \nOPENROWSET \n(\n    BULK 'Sales_BuyingGroups/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    HEADER_ROW = TRUE,\n    FIELDTERMINATOR ='|'\n) AS fct;\nGO\n\nCREATE VIEW lnd.vwDeliveryMethods\nAS\nSELECT * FROM \nOPENROWSET \n(\n    BULK 'Application_DeliveryMethods/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    HEADER_ROW = TRUE,\n    FIELDTERMINATOR ='|'\n) AS fct;\nGO\n\nCREATE VIEW lnd.vwCustomerCategories\nAS\nSELECT * FROM \nOPENROWSET \n(\n    BULK 'Sales_CustomerCategories/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    HEADER_ROW = TRUE,\n    FIELDTERMINATOR ='|'\n) AS fct;\nGO\n\nCREATE VIEW lnd.vwPeople\nAS\nSELECT * FROM \nOPENROWSET \n(\n    BULK 'Application_People/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    HEADER_ROW = TRUE,\n    FIELDTERMINATOR ='|'\n) AS fct;\nGO\n\nCREATE VIEW lnd.vwSuppliers\nAS\nSELECT * FROM \nOPENROWSET \n(\n    BULK 'Purchasing_Suppliers/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    HEADER_ROW = TRUE,\n    FIELDTERMINATOR ='|'\n) AS fct;\nGO\n\nCREATE VIEW lnd.vwSupplierCategories\nAS\nSELECT * FROM \nOPENROWSET \n(\n    BULK 'Purchasing_SupplierCategories/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    HEADER_ROW = TRUE,\n    FIELDTERMINATOR ='|'\n) AS fct;\nGO\n\nCREATE VIEW lnd.vwStockItems\nAS\nSELECT * FROM \nOPENROWSET \n(\n    BULK 'Warehouse_StockItems/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    HEADER_ROW = TRUE,\n    FIELDTERMINATOR ='|'\n) AS fct;\nGO\n\nCREATE VIEW lnd.vwColors\nAS\nSELECT * FROM \nOPENROWSET \n(\n    BULK 'Warehouse_Colors/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    HEADER_ROW = TRUE,\n    FIELDTERMINATOR ='|'\n) AS fct;\nGO\n\nCREATE VIEW lnd.vwPackageTypes\nAS\nSELECT * FROM \nOPENROWSET \n(\n    BULK 'Warehouse_PackageTypes/*.csv',\n    DATA_SOURCE = 'MIdlakedevBronze',\n    FORMAT = 'CSV',\n    PARSER_VERSION = '2.0',\n    HEADER_ROW = TRUE,\n    FIELDTERMINATOR ='|'\n) AS fct;\nGO\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "salesLDW",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}